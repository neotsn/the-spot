/*!
 * Conditioner by Motif v0.3.0 (2013-01-02)
 * Conditionally enable and disable form elements.
 * http://getmotif.com
 * 
 * @author Jonathan Pacheco <jonathan@lifeblue.com>
 */
!function(a){"use strict";var b={pluginName:"conditioner",autoGroup:!0,activeClass:"is-active",disabledClass:"is-disabled",dataReveal:"conditional-reveal",dataConceal:"conditional-conceal",dataGroup:"conditional-group",onInit:null,onEnable:null,onDisable:null},c={init:function(d){return this.each(function(){var c=a(this),e=a.extend(!0,{},b,d),f=c,g=a("#"+f.attr("data-"+e.dataReveal)),h=a("#"+f.attr("data-"+e.dataConceal));g.attr("data-conditional-target",g.attr("id")),h.attr("data-conditional-target",h.attr("id"))}),this.each(function(){function e(b,c){var d,e=b.filter(function(){return a(this).is(":checked")}),f=!1;return e.each(function(){d=a(this).val(),d===c&&(f=!0)}),f}var f,g,h=a(this),i=a.extend(!0,{},b,d),j=h,k=j.data(),l=j.attr("data-"+i.dataReveal),m=j.attr("data-"+i.dataConceal),n=a("#"+l),o=a("#"+m),p=j.attr("data-"+i.dataGroup),q=a("[data-"+i.dataGroup+"='"+p+"']"),r=j.val(),s=!1,t={origData:k,triggerElem:j,conditionalGroup:q,revealTargetID:l,concealTargetID:m,revealTarget:n,concealTarget:o,activeClass:i.activeClass,disabledClass:i.disabledClass,dataReveal:i.dataReveal,dataConceal:i.dataConceal,autoGroup:i.autoGroup,onInit:i.onInit,onEnable:i.onEnable,onDisable:i.onDisable};h.data("conditionalSettings",t),"function"==typeof i.onInit&&i.onInit(h),j.is("option")?(f=j.parent(),g=f.val(),g===r&&c.evaluate.call(h,"active"),f.on("change",function(){g=a(this).val(),g===r?c.evaluate.call(h,"active"):c.evaluate.call(h,"inactive")})):j.is("input[type='checkbox']")||j.is("input[type='radio']")?(r=j.val(),p=j.attr("name"),q=a("input[name='"+p+"']"),s=e(q,r),s===!0&&c.evaluate.call(h,"active"),q.on("change",function(){s=e(q,r),s===!0?c.evaluate.call(h,"active"):c.evaluate.call(h,"inactive")})):(""!==j.val().trim()&&c.evaluate.call(h,"active"),j.on("change",function(){""!==j.val().trim()?c.evaluate.call(h,"active"):c.evaluate.call(h,"inactive")}))})},filterInputs:function(b){var c=b,d=c.find("input, select, textarea"),e=c.attr("id"),f=[];return d.each(function(){var b=a(this).closest("[data-conditional-target]").attr("data-conditional-target");b===e&&f.push(a(this))}),f},gatherTriggers:function(b){var c=a(this),d=c.data("conditionalSettings"),e="",f="",g="";return"reveal"===b?(f=d.dataReveal,g=d.revealTargetID):"conceal"===b&&(f=d.dataConceal,g=d.concealTargetID),e="[data-"+f+"='"+g+"']",a(e)},evaluate:function(b){var d=a(this),e=d.data("conditionalSettings"),f=c.filterInputs.call(d,e.revealTarget),g=c.filterInputs.call(d,e.concealTarget),h={targetElem:e.revealTarget,allTriggers:c.gatherTriggers.call(d,"reveal"),affectedElems:f,state:b},i={targetElem:e.concealTarget,allTriggers:c.gatherTriggers.call(d,"conceal"),affectedElems:g,state:b};"active"===b?("undefined"!=typeof e.revealTargetID&&c.enable.call(d,h),"undefined"!=typeof e.concealTargetID&&c.disable.call(d,i)):"inactive"===b&&("undefined"!=typeof e.revealTargetID&&c.disable.call(d,h),"undefined"!=typeof e.concealTargetID&&c.enable.call(d,i))},disable:function(b){var c,d=a(this),e=d.data("conditionalSettings"),f=!1;if(b.targetElem.removeClass(e.activeClass).addClass(e.disabledClass),e.triggerElem.attr("data-conditional-enabled","false"),"inactive"===b.state){for(c=b.allTriggers.length;c>=0;c-=1)"true"===a(b.allTriggers[c]).attr("data-conditional-enabled")&&(f=!0);f||a(b.affectedElems).each(function(){a(this).prop("disabled",!0)})}else"active"===b.state&&a(b.affectedElems).each(function(){a(this).prop("disabled",!0)});"function"==typeof e.onDisable&&e.onDisable(d)},enable:function(b){var c,d=a(this),e=d.data("conditionalSettings"),f=!1;if(b.targetElem.removeClass(e.disabledClass).addClass(e.activeClass),e.triggerElem.attr("data-conditional-enabled","true"),"inactive"===b.state){for(c=b.allTriggers.length;c>=0;c-=1)"false"===a(b.allTriggers[c]).attr("data-conditional-enabled")&&(f=!0);f||a(b.affectedElems).each(function(){a(this).prop("disabled",!1)})}else"active"===b.state&&a(b.affectedElems).each(function(){a(this).prop("disabled",!1)});"function"==typeof e.onEnable&&e.onEnable(d)}};a.fn[b.pluginName]=function(a){return c[a]?c[a].apply(this,Array.prototype.slice.call(arguments,1)):a&&"object"!=typeof a?void console.log(b.pluginName+": Invalid method passed"):c.init.apply(this,arguments)}}(jQuery);