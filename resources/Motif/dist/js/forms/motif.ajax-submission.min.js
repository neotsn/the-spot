/*!
 * Motif Ajax Submission v0.2.0
 * http://getmotif.com
 * 
 * @author Jonathan Pacheco <jonathan@lifeblue.com>
 */
!function(a,b,c,d,e){"use strict";var f=function(b){this.$elem=a(b),this.elem=this.$elem[0]},g=a(c);f.prototype={defaults:{errorClass:"is-erroneous",successClass:"is-successful",alertErrorClass:"alert-panel--error",alertSuccessClass:"alert-panel--success",errorText:"There was an error submitting your form. Please contact the site's administrator.",successText:"Great! Your form has been submitted.",feedbackMessage:"append",clearForm:!0,scrollElem:null,callback:null},init:function(a){return this.$elem.length?(this.initVars(a),this.initValidation(),this):void 0},initVars:function(b){this.config=b,this.metadata=this.$elem.data("ajax-submission-options"),this.options=a.extend(!0,{},this.defaults,this.config,this.metadata),this.error=!1,this.method=this.$elem.attr("method")||"post",this.action=this.$elem.attr("action")},submitForm:function(){var b=this;a.ajax({type:b.method,url:b.action,data:decodeURIComponent(b.$elem.serialize()),cache:!1}).done(function(a){b.ajaxCallback.call(b,a)}).fail(function(a){b.ajaxCallback.call(b,a,!0)}).always(function(a){g.trigger("ajax/complete",[b.$elem])})},ajaxCallback:function(a,b){return b&&(this.error=!0),this.afterSubmit(),a},afterSubmit:function(){var a=this.options.feedbackMessage?this.buildMessage():!1;this.error||this.resetForm(),this.placeMessage(a),"function"==typeof this.options.callback&&this.options.callback()},buildMessage:function(){var a='<p class="';return a+=this.error?this.options.alertErrorClass:this.options.alertSuccessClass,a+='">',a+=this.error?this.options.errorText:this.options.successText,a+="</p>"},resetForm:function(){return this.options.clearForm&&(this.elem.reset(),this.$elem.find("label").removeClass(this.options.successClass)),this.options.clearForm},placeMessage:function(b){var c;if(b&&this.options.feedbackMessage){switch(c=a(b),this.options.feedbackMessage){case"prepend":this.$elem.prepend(c);break;case"append":this.$elem.append(c);break;case"before":this.$elem.before(c);break;case"after":this.$elem.after(c)}this.goToMessage(c)}return c},goToMessage:function(b){var c=this.options.scrollElem||a("html, body");c.animate({scrollTop:b.offset().top},500),this.removeMessage(b)},removeMessage:function(a){setTimeout(function(){a.slideUp(150,function(){a.remove()})},8e3)},initValidation:function(){var a=this;a.$elem.plugin("gauntlet",{ajaxSubmit:function(){a.submitForm.call(a)}})}},f.defaults=f.prototype.defaults,d.apps.AjaxSubmission=f}(jQuery,window,document,window.Motif=window.Motif||{utils:{},apps:{}}),$.createPlugin("ajaxSubmission",window.Motif.apps.AjaxSubmission);